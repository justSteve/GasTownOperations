# GT Dashboard TMux Keybindings
#
# Source this file in your ~/.tmux.conf:
#   source-file /root/gtOps/daemon/gt-tmux.conf
#
# Or source it manually:
#   tmux source-file /root/gtOps/daemon/gt-tmux.conf

# === Scrollback & Mouse ===
set -g mouse on                    # Enable mouse scrolling (may not work in VSCode)
set -g history-limit 50000         # Increase scrollback buffer (default 2000)

# Quick scroll shortcuts - enter copy mode and page up in one key
bind-key PPage copy-mode -u        # Ctrl+B PgUp = enter copy mode scrolled up

# Logging - toggle with Ctrl+B L
bind-key L pipe-pane -o "cat >> /root/gtOps/logs/tmux-#{session_name}-#{window_name}.log" \; display-message "Logging toggled"

# GT-specific prefix: Ctrl+g
bind-key -n C-g switch-client -T gt-keys

# Session switching (Ctrl+g then r/u)
bind-key -T gt-keys r switch-client -t gt-root
bind-key -T gt-keys u run-shell "echo 'gt-user is in gtuser tmux - use: sudo -u gtuser tmux attach -t gt-user'"

# Window switching within gt-root (Ctrl+g then d/m)
bind-key -T gt-keys d select-window -t gt-root:dashboard
bind-key -T gt-keys m select-window -t gt-root:main

# Quick status popup (Ctrl+g then s) - tmux 3.2+
bind-key -T gt-keys s display-popup -E -w 80% -h 60% "/root/gtOps/daemon/gt-dashboard.sh status; echo; echo 'Press Enter to close'; read"

# Quick gt status popup (Ctrl+g then a)
bind-key -T gt-keys a display-popup -E -w 80% -h 60% "sudo -u gtuser bash -c 'cd /home/gtuser/gt && gt status'; echo; echo 'Press Enter to close'; read"

# Help (Ctrl+g then ?)
bind-key -T gt-keys ? display-message "GT Keys: r=gt-root, u=gt-user info, d=dashboard, m=main, s=status, a=agents"
